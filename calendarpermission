<#
.\SYNOPSIS
    Managing inbox and calendar permissions

.\DESCRIPTION
    Simple way to grant mailbox access and calendar access with other users.

.\NOTES
    Author: Ben Lam
    Last Edit: 27 February 2018.

#>

# Enter the full admin email address
$cred = get-credential

enter-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell/ -Credential $cred -Authentication Basic -AllowRedirection


function share-calendar {
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the the user's calendar to share for example ben.lam:\calendar")]
      [string]$user1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user to have access to the calendar")]
      [string]$user2,

      [Parameter(Mandatory=$True,
      HelpMessage = 'Enter one of the following: "owner", "publishing editor", "editor", "publishing author", "author", "nonediting author", "reviewer", "contributor", "None"')]
      [Validateset("owner", "publishing editor", "editor", "publishing author", "author", "nonediting author", "reviewer", "contributor", "None")] 
      [string]$rights

)


add-mailboxfolderpermission $user1 -user $user2 -Accessrights 

}


function grant-send {

param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user's mailbox to grant the send on behalf to permission from")]
      [string]$user1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user to receive the permission")]
      [string]$user2
)


set-mailbox $user1 -grantsendonbehalfto $user2

}


function add-sendas {

param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user's mailbox to grant the send as permission from")]
      [string]$user1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user to receive the permission")]
      [string]$user2
)

add-recipientpermission $user1 -accessrights SendAs -Trustee $User2

}


function add-fullaccess {

param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user's mailbox to grant full access from")]
      [string]$user1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME of the user to receive the permission")]
      [string]$user2
)


add-mailboxpermission user1 -user user2 -Accessrights FullAccess

}

exit
