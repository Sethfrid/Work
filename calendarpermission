<#
.\SYNOPSIS
    Managing inbox and calendar permissions

.\DESCRIPTION
    Simple way to grant mailbox access and calendar access with other users.

.\NOTES
    Author: Ben Lam
    Last Edit: 27 February 2018.

#>

$cred = get-credential

enter-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri https://ps.outlook.com/powershell/ -Credential $cred -Authentication Basic -AllowRedirection



      [string]$user1 = read-host "Enter the the user's calendar to share for example ben.lam:\calendar"

      [string]$user2 = read-host "Enter the SAMACCOUNTNAME of the user to have access to the calendar"
      
      [string]$rights = read-host = 'Enter one of the following: "owner", "publishing editor", "editor", "publishing author", "author", "nonediting author", "reviewer", "contributor", "None" '


add-mailboxfolderpermission $user1 -user $user2 -Accessrights $rights





    [string]$user1 = read-host = "Enter the SAMACCOUNTNAME of the user's mailbox to grant permission from"

    
    [string]$user2 = read-host "Enter the SAMACCOUNTNAME of the user to receive the permission"


set-mailbox $user1 -grantsendonbehalfto $user2


add-recipientpermission $user1 -accessrights SendAs -Trustee $User2


add-mailboxpermission $user1 -user $user2 -Accessrights FullAccess

