Set-ADUser samaccountname -ChangePasswordAtLogon $True


#########

$params = @{

	displayname = "Name"
	samaccountname = "Fname.Lname"
	givenname = "Fname"
	surname = "Lname"
	company = "Company"
	postalcode = "Post Code"
	path = "OU=OU,OU=Managed Users,DC=Domain,DC=DC,DC=DC"
	officephone = ""
	title = ""
	description = ""
	userprincipalname = "email"
	emailaddress = "email"
	enabled = $true
	accountpassword = (ConvertTo-SecureString -AsPlainText "Password1!" -Force)
	telephonenumber = ""
	otherattributes = @{proxyAddresses ="SMTP:email"}
}

new-aduser @params

#########

Get-ADUser -Identity FName.LName -Properties memberof |
Select-Object -ExpandProperty memberof |
Add-ADGroupMember -Members FName.LName

#If user only requires minimal groups

add-adgroupmember -identity "sec-emsE5" "SAMACCOUNTNAME"

add-adgroupmember -identity "sec-o365e5" "SAMACCOUNTNAME"

###################

param(
      [Parameter(Mandatory=$True)]
      [string]$firstname,

      [Parameter(Mandatory=$True)]
      [string]$lastname,

      [Parameter(Mandatory=$True)]
      [string]$title,

      [Parameter(Mandatory=$True)]
      [int]$tel

)

$sam = $firstname + "." + $lastname

$samn = $sam.ToLower()

$domain = "@ukfinance.org.uk"

$params = @{
	    name = $firstname + " " + $lastname
            displayname = $firstname + " " + $lastname
            samaccountname = $sam
	    givenname = $firstname
	    surname = $lastname
	    company = "UK Finance"
	    officephone = $tel
	    postalcode = "EC2R 7HJ"
	    path = "OU=Angel Court Users,OU=Managed Users,DC=ukfinance,DC=org,DC=uk"
	    title = $title
	    description = $title
	    userprincipalname = $samn + $domain
	    EmailAddress = $samn + $domain
	    enabled = $true
	    accountpassword = (ConvertTo-SecureString -AsPlainText "Password1!" -Force)
	    Otherattributes = @{proxyAddresses = "SMTP:$samn" + "$domain"}
} 

new-aduser @params
