function Create-User {
   [cmdletbinding()]
    param(
          [Parameter(Mandatory=$True)]
          [string]$firstname,

          [Parameter(Mandatory=$True)]
          [string]$lastname,

          [Parameter(Mandatory=$True)]
          [string]$jobtitle,

          [Parameter(Mandatory=$True,
          HelpMessage = "Press Enter if no number to enter")]
             [AllowEmptyString()]
          [string]$tel,

          [Parameter(Mandatory=$True,
          HelpMessage = "Press Enter if no number to enter")]
             [AllowEmptyString()]
          [string]$mobile,

          [Parameter(Mandatory=$True)]
            [string]$ticket
    )

    $sam = $firstname.ToLower() + "." + $lastname.ToLower()

    $date = get-date

    $newuser = @{
            displayname = $firstname + " " + $lastname
            name = $firstname + " " + $lastname
            samaccountname = $sam
               givenname = $firstname
               surname = $lastname
               company = "Company"
               officephone = $tel
            mobile = $mobile
               path = "OU=Angel Court Users,OU=Managed Users,DC=domain,DC=org,DC=uk"
               title = $jobtitle
               description = "Account created on $date by $env:USERNAME (T# $ticket )"
               userprincipalname = "$sam@domain.org.uk"
               EmailAddress = "$sam@domain.org.uk"
               enabled = $true
               accountpassword = read-host "Enter password for the new user" -AsSecureString
               Otherattributes = @{proxyAddresses = ("SMTP:$sam" + "@domain.org.uk"), ("SIP:$sam" + "@domain.org.uk")}
                  }
new-aduser @newuser
}


function Copy-Group {
[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the source SAMACCOUNTNAME")]
      [string]$username1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the destination SAMACCOUNTNAME")]
      [string]$username2
)

Get-ADUser -Identity $username1 -Properties memberof |
Select-Object -ExpandProperty memberof |
Add-ADGroupMember -Members $username2

}


function Set-Group {
[cmdletbinding()]
param (
          [Parameter(Mandatory=$True)]
          [string]$username
       )

$build = read-host -Prompt "Choose 1 for x86, 2 for x64, 3 for FFB or 4 for Adobe CC."

switch ($build) {

1 {add-adgroupmember -identity "Production Main Pool" -members $username}

2 {add-adgroupmember -identity "Production Office x64 Desktop" -members $username}

3 {add-adgroupmember -identity "Production FFB Desktop" -members $username}

4 {add-adgroupmember -identity "Production AdobeCC Desktop" -members $username}

}


add-adgroupmember -identity "sec-emsE5" "$username"

add-adgroupmember -identity "sec-o365e5" "$username"

add-adgroupmember -identity "sec-proxy-user" "$username"

add-adgroupmember -identity "sec_proxy-sync" "$username"

add-adgroupmember -identity "sec-domestic-plan" "$username"

add-adgroupmember -identity AIP "$username"


}


function Create-Adminuser {

    param(
          [Parameter(Mandatory=$True)]
          [string]$firstname,

          [Parameter(Mandatory=$True)]
          [string]$lastname

    )

    $params = @{

        displayname = $firstname + " " + $lastname
        name = $firstname + " " + $lastname
           samaccountname = "adminqnrl" + $firstname.ToLower()[0] + $lastname.ToLower()[0]
           givenname = $firstname
           surname = $lastname
           path = "OU=Admin Accounts,OU=Managed Users,DC=domain,DC=org,DC=uk"
           userprincipalname = "adminqnrl" + $firstname.ToLower()[0] + $lastname.ToLower()[0] + "@domain.org.uk"
           enabled = $true
           accountpassword = read-host "Enter password for new user" -AsSecureString
    }
new-aduser @params

}
