function Add-Calendar {

[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME or E-mail of the source user's calendar ")]
      [string]$username1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME or E-mail of the user to have access to the calendar")]
      [string]$username2,

      [Parameter(Mandatory=$True,
      HelpMessage = 'Visit this site for full list: https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/add-mailboxfolderpermission?view=exchange-ps ')]
      [string]$access,

[Parameter(Mandatory=$True,
          HelpMessage = "Choose delegate or canviewprivateitems, "delegate, canviewprivateitems" or none"]
                  [AllowEmptyString()]
          [string]$flag

)

$calendar = $username1 + ":" + "\calendar"

add-mailboxfolderpermission $calendar -user $username2 -Accessrights $access -sharingpermissionflags $flag

}


function Set-Calendar {

[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME or E-mail of the source user's calendar ")]
      [string]$username1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME or E-mail of the user to have access to the calendar")]
      [string]$username2,

      [Parameter(Mandatory=$True,
      HelpMessage = 'Visit this site for full list: https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/add-mailboxfolderpermission?view=exchange-ps ')]
      [string]$access,

[Parameter(Mandatory=$True,
          HelpMessage = "Choose delegate or canviewprivateitems, "delegate, canviewprivateitems" or none"]
                  [AllowEmptyString()]
          [string]$flag
)

$calendar = $username1 + ":" + "\calendar"

set-mailboxfolderpermission $calendar -user $username2 -Accessrights $access -sharingpermissionflags $flag

}


function Check-Calendar {

[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME or E-mail of the source uuser's calendar ")]
      [string]$username

)

$calendar = $username + ":" + "\calendar"

get-mailboxfolderpermission $calendar

}
