function Add-Calendar {

[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the source SAMACCOUNTNAME or E-mail calendar")]
      [string]$username1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the destination SAMACCOUNTNAME or E-mail calendar")]
      [string]$username2,

      [Parameter(Mandatory=$True,
      HelpMessage = 'Visit this site for full list: https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/add-mailboxfolderpermission?view=exchange-ps ')]
      [string]$access
)

$calendar = $username1 + ":" + "\calendar"

add-mailboxfolderpermission $calendar -user $username2 -Accessrights $access

}


function Set-Calendar {

[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the source SAMACCOUNTNAME or E-mail calendar")]
      [string]$username1,

      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the destination SAMACCOUNTNAME or E-mail calendar")]
      [string]$username2,

      [Parameter(Mandatory=$True,
      HelpMessage = 'Visit this site for full list: https://docs.microsoft.com/en-us/powershell/module/exchange/mailboxes/add-mailboxfolderpermission?view=exchange-ps ')]
      [string]$access

)

$calendar = $username1 + ":" + "\calendar"

set-mailboxfolderpermission $calendar -user $username2 -Accessrights $access

}


function Check-Calendar {

[cmdletbinding()]
param(
      [Parameter(Mandatory=$True,
      HelpMessage = "Enter the SAMACCOUNTNAME or E-mail of the user's calendar to check")]
      [string]$username

)

$calendar = $username + ":" + "\calendar"

get-mailboxfolderpermission $calendar

} 
